navier_testproblem

specification of reference Navier-Stokes problem.

choose specific example (default is cavity)
     1  Channel domain
     2  Flow over a backward facing step
     3  Lid driven cavity
     4  Flow over a plate
     5  Flow over an obstacle
     6  Flow in a symmetric step channel
 : 1
channel domain: L? (default unity) : 10


Grid generation for extended channel domain.
grid parameter? (default is 4) : 
   Grid generation for x-channel ...done.
generated datatfile: channel_grid.mat 
Q1-Q1/Q1-P0/Q2-Q1/Q2-P1: 1/2/3/4? (default Q1-P0) : 4
setting up Q2-P1 matrices...  done
system matrices saved in channel_stokes_nobc.mat ...
(incompressible flow problem in channel domain ...
viscosity parameter (default 1/100) : 1/1000
Picard/Newton/hybrid linearization 1/2/3 (default hybrid) : 
number of Picard iterations (default 3) : 
number of Newton iterations (default 5) : 
nonlinear tolerance (default 1.1*eps) : 
stokes system ...
setting up Q2 convection matrix...  done.
uniform/exponential streamlines 1/2 (default uniform) : 


initial nonlinear residual is 5.083466e+00 
Stokes solution residual is 1.283025e+00

Picard iteration number 1 
setting up Q2 convection matrix...  done.
nonlinear residual is 8.439920e-15
   velocity change is 4.788373e-13

Picard iteration number 2 
setting up Q2 convection matrix...  done.
nonlinear residual is 1.223110e-15
   velocity change is 4.873851e-13

finished, nonlinear convergence test satisfied

Natural outflow on right hand vertical boundary ..
FAST Q2-P1 NS a posteriori error estimation 
checking edge numbering and computing edge lengths ... done
Q2-P1 local N-S error estimator ...  
interior residual RHS assembly took 1.2324e-01 seconds
flux jump RHS assembly took 3.8681e-02 seconds
LDLT factorization took 1.1138e-02 seconds
triangular solves took 1.0651e-02 seconds
      computing divergence of discrete velocity solution ...  done
      estimated velocity divergence error:  4.562830e-14 
estimated energy error is 1.8457e-12 
plotting element data... done


refviscosity= viscosity;
save steadysol xns nnv refviscosity

unsteady_channel_navier
Unsteady flow in a channel domain ...
viscosity parameter (default 1/500) : 1/1000
Discrete Saddle-Point DAE system ...
target time? (default 1e8) : 
number of timesteps (x200)? (default 5) : 
accuracy tolerance? (default 3e-5) : 1e-4
number of Picard steps? (default 1) : 0
averaging frequency? (default 10) : 
plot solution evolution? 1/0 : 1
plotting frequency (default every 10 time steps) : 4
movie frame rate [fps] (default 16) : 8
x coordinate for the horisontal velocity profile (default L/2) : 
Solving discrete N-S system using stabilized TR ...

AxBhandle = @defaultAxB

intermediate (CheckPoint) datafile: stabtrNS_end

  initial nonlinear residual is 7.161162e-02 
             boundary change is 2.921165e-08 
setting up Q2 convection matrix...  done.

 StabTR with no nonlinear corrections
   step  timestep       time        residual      divresidual     acceleration
     1   1.000e-09     2.000e-09    0.000e+00     0.000e+00        3.182e+01
     2   1.000e-09     2.000e-09    2.717e-14     1.076e-23        3.182e+01
     3   1.193e-05     1.193e-05    2.631e-14     7.879e-20        3.182e+01
     4   2.642e-04     2.761e-04    2.766e-14     1.695e-18        3.181e+01
     5   8.604e-03     8.880e-03    2.697e-14     5.409e-17        3.173e+01
     6   8.247e-03     1.713e-02    2.330e-14     8.703e-17        2.908e+01
     7   6.663e-03     2.379e-02    2.094e-14     1.237e-16        2.681e+01
     8   9.559e-03     3.335e-02    2.075e-14     1.581e-16        2.506e+01
     9   7.189e-03     4.054e-02    1.677e-14     1.827e-16        2.278e+01
    10   8.177e-03     4.871e-02    1.613e-14     2.227e-16        2.121e+01
    11   8.547e-03     5.726e-02    1.503e-14     2.549e-16        1.953e+01
    12   8.206e-03     6.547e-02    1.402e-14     2.850e-16        1.794e+01
    13   9.025e-03     7.449e-02    1.314e-14     3.141e-16        1.652e+01
    14   8.847e-03     8.334e-02    1.279e-14     3.216e-16        1.510e+01
    15   9.291e-03     9.263e-02    1.108e-14     3.378e-16        1.382e+01
    16   9.580e-03     1.022e-01    1.095e-14     3.569e-16        1.259e+01
    17   9.777e-03     1.120e-01    8.981e-15     3.747e-16        1.144e+01
    18   1.021e-02     1.222e-01    7.479e-15     3.791e-16        1.038e+01
    19   1.046e-02     1.327e-01    7.584e-15     4.341e-16        9.371e+00
    20   1.087e-02     1.435e-01    6.361e-15     4.595e-16        8.441e+00
    21   1.125e-02     1.548e-01    5.806e-15     4.629e-16        7.574e+00
    22   1.164e-02     1.664e-01    5.487e-15     4.707e-16        6.770e+00
    23   1.211e-02     1.785e-01    4.376e-15     4.902e-16        6.029e+00
    24   1.257e-02     1.911e-01    4.210e-15     5.238e-16        5.345e+00
    25   1.310e-02     2.042e-01    3.444e-15     5.386e-16        4.718e+00
    26   1.366e-02     2.179e-01    3.310e-15     5.479e-16        4.144e+00
    27   1.426e-02     2.321e-01    2.840e-15     5.502e-16        3.622e+00
    28   1.493e-02     2.471e-01    2.410e-15     5.649e-16        3.150e+00
    29   1.565e-02     2.627e-01    1.993e-15     5.602e-16        2.724e+00
    30   1.645e-02     2.792e-01    1.728e-15     5.500e-16        2.342e+00
    31   1.732e-02     2.965e-01    1.406e-15     5.649e-16        2.004e+00
    32   1.829e-02     3.148e-01    1.202e-15     5.641e-16        1.705e+00
    33   1.936e-02     3.341e-01    1.022e-15     5.465e-16        1.446e+00
    34   2.055e-02     3.547e-01    9.297e-16     5.543e-16        1.223e+00
    35   2.188e-02     3.765e-01    7.128e-16     5.891e-16        1.035e+00
    36   2.335e-02     3.999e-01    5.501e-16     5.690e-16        8.811e-01
    37   2.500e-02     4.249e-01    5.538e-16     5.717e-16        7.579e-01
    38   2.681e-02     4.517e-01    4.188e-16     5.744e-16        6.634e-01
    39   2.877e-02     4.805e-01    3.614e-16     6.039e-16        5.942e-01
    40   3.082e-02     5.113e-01    3.408e-16     6.166e-16        5.458e-01
    41   3.283e-02     5.441e-01    2.992e-16     5.915e-16        5.134e-01
    42   3.465e-02     5.788e-01    2.876e-16     5.705e-16        4.921e-01
    43   3.615e-02     6.149e-01    2.881e-16     5.737e-16        4.780e-01
    44   3.728e-02     6.522e-01    2.726e-16     5.794e-16        4.679e-01
    45   3.806e-02     6.903e-01    2.602e-16     6.060e-16        4.600e-01
    46   3.858e-02     7.289e-01    2.821e-16     5.874e-16        4.533e-01
    47   3.895e-02     7.678e-01    2.744e-16     6.001e-16        4.471e-01
    48   3.923e-02     8.070e-01    2.746e-16     6.028e-16        4.412e-01
    49   3.947e-02     8.465e-01    2.665e-16     5.623e-16        4.355e-01
    50   3.968e-02     8.862e-01    2.651e-16     5.674e-16        4.300e-01
    51   3.988e-02     9.261e-01    2.735e-16     5.866e-16        4.246e-01
    52   4.007e-02     9.661e-01    2.660e-16     5.847e-16        4.193e-01
    53   4.024e-02     1.006e+00    2.682e-16     5.810e-16        4.141e-01
    54   4.040e-02     1.047e+00    2.764e-16     5.760e-16        4.089e-01
    55   4.058e-02     1.087e+00    2.750e-16     5.784e-16        4.037e-01
    56   4.077e-02     1.128e+00    2.708e-16     5.767e-16        3.984e-01
    57   4.095e-02     1.169e+00    2.792e-16     5.549e-16        3.933e-01
    58   4.111e-02     1.210e+00    2.758e-16     5.477e-16        3.883e-01
    59   4.128e-02     1.251e+00    2.729e-16     5.914e-16        3.834e-01
    60   2.073e-02     1.272e+00  --- Averaging step
    60   4.146e-02     1.272e+00    9.790e-04     5.701e-16        3.787e-01
    61   4.163e-02     1.314e+00    2.696e-16     9.916e-16        3.745e-01
    62   4.212e-02     1.356e+00    2.679e-16     5.721e-16        3.700e-01
    63   4.224e-02     1.398e+00    2.842e-16     5.769e-16        3.655e-01
    64   4.240e-02     1.441e+00    2.668e-16     5.995e-16        3.610e-01
    65   4.259e-02     1.483e+00    2.713e-16     5.895e-16        3.566e-01
    66   4.277e-02     1.526e+00    2.832e-16     5.686e-16        3.522e-01
    67   4.293e-02     1.569e+00    2.889e-16     5.739e-16        3.480e-01
    68   4.310e-02     1.612e+00    2.767e-16     5.703e-16        3.440e-01
    69   4.325e-02     1.655e+00    2.682e-16     5.820e-16        3.401e-01
    70   2.170e-02     1.677e+00  --- Averaging step
    70   4.340e-02     1.677e+00    7.587e-04     5.681e-16        3.365e-01
    71   4.353e-02     1.720e+00    2.804e-16     9.928e-16        3.329e-01
    72   4.408e-02     1.765e+00    2.778e-16     5.764e-16        3.293e-01
    73   4.421e-02     1.809e+00    2.804e-16     5.923e-16        3.257e-01
    74   4.435e-02     1.853e+00    2.810e-16     5.683e-16        3.221e-01
    75   4.451e-02     1.898e+00    2.714e-16     5.532e-16        3.186e-01
    76   4.467e-02     1.942e+00    2.693e-16     5.764e-16        3.152e-01
    77   4.482e-02     1.987e+00    2.751e-16     5.896e-16        3.119e-01
    78   4.497e-02     2.032e+00    2.825e-16     6.075e-16        3.086e-01
    79   4.514e-02     2.077e+00    2.822e-16     5.615e-16        3.054e-01
    80   2.265e-02     2.100e+00  --- Averaging step
    80   4.530e-02     2.100e+00    6.928e-04     5.705e-16        3.023e-01
    81   4.547e-02     2.145e+00    2.801e-16     9.718e-16        2.991e-01
    82   4.610e-02     2.191e+00    2.810e-16     5.896e-16        2.960e-01
    83   4.629e-02     2.238e+00    2.896e-16     5.902e-16        2.929e-01
    84   4.648e-02     2.284e+00    2.709e-16     5.711e-16        2.899e-01
    85   4.668e-02     2.331e+00    2.827e-16     5.874e-16        2.869e-01
    86   4.689e-02     2.378e+00    2.815e-16     6.265e-16        2.839e-01
    87   4.711e-02     2.425e+00    2.762e-16     6.128e-16        2.810e-01
    88   4.734e-02     2.472e+00    2.807e-16     5.895e-16        2.780e-01
    89   4.758e-02     2.520e+00    2.765e-16     5.471e-16        2.751e-01
    90   2.392e-02     2.544e+00  --- Averaging step
    90   4.784e-02     2.544e+00    5.822e-04     5.626e-16        2.723e-01
    91   4.810e-02     2.592e+00    2.982e-16     9.551e-16        2.694e-01
    92   4.885e-02     2.641e+00    2.826e-16     5.874e-16        2.666e-01
    93   4.912e-02     2.690e+00    2.894e-16     5.898e-16        2.639e-01
    94   4.939e-02     2.739e+00    2.765e-16     5.849e-16        2.612e-01
    95   4.969e-02     2.789e+00    2.857e-16     5.903e-16        2.585e-01
    96   5.001e-02     2.839e+00    2.975e-16     5.918e-16        2.558e-01
    97   5.034e-02     2.889e+00    3.101e-16     5.786e-16        2.532e-01
    98   5.068e-02     2.940e+00    2.782e-16     5.854e-16        2.505e-01
    99   5.103e-02     2.991e+00    2.763e-16     5.907e-16        2.479e-01
   100   2.570e-02     3.017e+00  --- Averaging step
   100   5.140e-02     3.017e+00    4.837e-04     5.657e-16        2.454e-01
   101   5.177e-02     3.068e+00    2.833e-16     9.455e-16        2.428e-01
   102   5.269e-02     3.121e+00    2.956e-16     5.843e-16        2.403e-01
   103   5.307e-02     3.174e+00    2.871e-16     5.888e-16        2.379e-01
   104   5.347e-02     3.228e+00    2.976e-16     6.082e-16        2.355e-01
   105   5.388e-02     3.282e+00    2.871e-16     5.964e-16        2.331e-01
   106   5.430e-02     3.336e+00    2.855e-16     5.934e-16        2.307e-01
   107   5.473e-02     3.391e+00    3.038e-16     5.767e-16        2.283e-01
   108   5.516e-02     3.446e+00    2.827e-16     5.696e-16        2.260e-01
   109   5.561e-02     3.501e+00    2.928e-16     5.807e-16        2.237e-01
   110   2.803e-02     3.529e+00  --- Averaging step
   110   5.606e-02     3.529e+00    4.157e-04     5.675e-16        2.215e-01
   111   5.651e-02     3.586e+00    2.925e-16     9.677e-16        2.193e-01
   112   5.763e-02     3.643e+00    3.085e-16     6.000e-16        2.171e-01
   113   5.808e-02     3.702e+00    2.983e-16     5.992e-16        2.150e-01
   114   5.855e-02     3.760e+00    2.841e-16     6.093e-16        2.129e-01
   115   5.902e-02     3.819e+00    2.944e-16     5.787e-16        2.108e-01
   116   5.950e-02     3.879e+00    2.989e-16     5.985e-16        2.087e-01
   117   5.997e-02     3.939e+00    2.969e-16     5.998e-16        2.067e-01
   118   6.044e-02     3.999e+00    2.832e-16     5.590e-16        2.048e-01
   119   6.091e-02     4.060e+00    2.936e-16     5.953e-16        2.028e-01
   120   3.069e-02     4.091e+00  --- Averaging step
   120   6.137e-02     4.091e+00    4.025e-04     5.251e-16        2.009e-01
   121   6.184e-02     4.152e+00    2.884e-16     9.177e-16        1.990e-01
   122   6.316e-02     4.216e+00    3.002e-16     5.980e-16        1.971e-01
   123   6.362e-02     4.279e+00    2.890e-16     6.029e-16        1.953e-01
   124   6.411e-02     4.343e+00    3.003e-16     5.745e-16        1.934e-01
   125   6.459e-02     4.408e+00    3.043e-16     5.674e-16        1.917e-01
   126   6.506e-02     4.473e+00    3.021e-16     5.937e-16        1.899e-01
   127   6.553e-02     4.539e+00    2.989e-16     5.866e-16        1.882e-01
   128   6.599e-02     4.605e+00    2.954e-16     5.799e-16        1.865e-01
   129   6.646e-02     4.671e+00    2.883e-16     5.880e-16        1.848e-01
   130   3.347e-02     4.704e+00  --- Averaging step
   130   6.693e-02     4.704e+00    3.705e-04     5.755e-16        1.831e-01
   131   6.742e-02     4.772e+00    2.987e-16     9.852e-16        1.814e-01
   132   6.896e-02     4.841e+00    3.034e-16     5.732e-16        1.797e-01
   133   6.946e-02     4.910e+00    2.943e-16     5.661e-16        1.781e-01
   134   6.997e-02     4.980e+00    2.917e-16     6.065e-16        1.765e-01
   135   7.046e-02     5.051e+00    2.998e-16     5.594e-16        1.749e-01
   136   7.096e-02     5.122e+00    2.985e-16     5.497e-16        1.734e-01
   137   7.148e-02     5.193e+00    2.913e-16     5.722e-16        1.718e-01
   138   7.200e-02     5.265e+00    2.969e-16     6.046e-16        1.703e-01
   139   7.252e-02     5.338e+00    2.976e-16     5.689e-16        1.688e-01
   140   3.652e-02     5.374e+00  --- Averaging step
   140   7.304e-02     5.374e+00    3.221e-04     5.327e-16        1.673e-01
   141   7.357e-02     5.448e+00    3.040e-16     9.041e-16        1.658e-01
   142   7.538e-02     5.523e+00    3.015e-16     5.638e-16        1.643e-01
   143   7.594e-02     5.599e+00    3.033e-16     5.596e-16        1.628e-01
   144   7.652e-02     5.676e+00    3.081e-16     5.935e-16        1.614e-01
   145   7.709e-02     5.753e+00    3.022e-16     5.750e-16        1.599e-01
   146   7.766e-02     5.830e+00    2.944e-16     5.886e-16        1.585e-01
   147   7.823e-02     5.909e+00    3.089e-16     5.965e-16        1.571e-01
   148   7.879e-02     5.987e+00    2.990e-16     5.919e-16        1.557e-01
   149   7.937e-02     6.067e+00    3.063e-16     5.853e-16        1.543e-01
   150   3.998e-02     6.107e+00  --- Averaging step
   150   7.996e-02     6.107e+00    2.931e-04     5.699e-16        1.530e-01
   151   8.055e-02     6.187e+00    3.078e-16     9.555e-16        1.516e-01
   152   8.267e-02     6.270e+00    3.092e-16     5.688e-16        1.503e-01
   153   8.328e-02     6.353e+00    2.911e-16     5.949e-16        1.489e-01
   154   8.392e-02     6.437e+00    3.132e-16     5.647e-16        1.476e-01
   155   8.454e-02     6.522e+00    3.154e-16     5.361e-16        1.463e-01
   156   8.517e-02     6.607e+00    2.998e-16     5.576e-16        1.450e-01
   157   8.579e-02     6.693e+00    3.049e-16     5.916e-16        1.437e-01
   158   8.641e-02     6.779e+00    3.147e-16     5.777e-16        1.424e-01
   159   8.704e-02     6.866e+00    3.083e-16     6.014e-16        1.412e-01
   160   4.384e-02     6.910e+00  --- Averaging step
   160   8.768e-02     6.910e+00    2.722e-04     5.405e-16        1.399e-01
   161   8.832e-02     6.998e+00    2.937e-16     9.689e-16        1.387e-01
   162   9.081e-02     7.089e+00    3.003e-16     5.964e-16        1.375e-01
   163   9.152e-02     7.181e+00    3.205e-16     5.671e-16        1.363e-01
   164   9.226e-02     7.273e+00    3.154e-16     5.931e-16        1.351e-01
   165   9.295e-02     7.366e+00    3.088e-16     5.861e-16        1.339e-01
   166   9.364e-02     7.459e+00    3.084e-16     5.735e-16        1.327e-01
   167   9.435e-02     7.554e+00    3.090e-16     5.793e-16        1.315e-01
   168   9.507e-02     7.649e+00    3.158e-16     5.840e-16        1.303e-01
   169   9.577e-02     7.745e+00    3.118e-16     5.772e-16        1.292e-01
   170   4.824e-02     7.793e+00  --- Averaging step
   170   9.648e-02     7.793e+00    2.411e-04     5.695e-16        1.280e-01
   171   9.722e-02     7.890e+00    3.134e-16     9.563e-16        1.270e-01
   172   1.002e-01     7.990e+00    3.290e-16     5.834e-16        1.259e-01
   173   1.010e-01     8.091e+00    3.124e-16     5.971e-16        1.247e-01
   174   1.018e-01     8.193e+00    3.342e-16     5.771e-16        1.236e-01
   175   1.026e-01     8.296e+00    3.073e-16     5.808e-16        1.225e-01
   176   1.034e-01     8.399e+00    3.194e-16     5.768e-16        1.215e-01
   177   1.042e-01     8.503e+00    3.219e-16     5.473e-16        1.204e-01
   178   1.049e-01     8.608e+00    3.341e-16     5.640e-16        1.193e-01
   179   1.057e-01     8.714e+00    3.288e-16     5.835e-16        1.183e-01
   180   5.326e-02     8.767e+00  --- Averaging step
   180   1.065e-01     8.767e+00    2.092e-04     5.649e-16        1.172e-01
   181   1.073e-01     8.874e+00    3.367e-16     9.895e-16        1.163e-01
   182   1.108e-01     8.985e+00    3.300e-16     6.127e-16        1.153e-01
   183   1.118e-01     9.097e+00    3.328e-16     6.242e-16        1.143e-01
   184   1.127e-01     9.210e+00    3.327e-16     5.868e-16        1.133e-01
   185   1.136e-01     9.323e+00    3.317e-16     6.043e-16        1.123e-01
   186   1.144e-01     9.438e+00    3.353e-16     5.589e-16        1.113e-01
   187   1.153e-01     9.553e+00    3.426e-16     5.794e-16        1.103e-01
   188   1.162e-01     9.669e+00    3.466e-16     5.412e-16        1.093e-01
   189   1.171e-01     9.786e+00    3.319e-16     5.631e-16        1.084e-01
   190   5.897e-02     9.845e+00  --- Averaging step
   190   1.179e-01     9.845e+00    1.815e-04     5.514e-16        1.075e-01
   191   1.188e-01     9.964e+00    3.324e-16     9.214e-16        1.066e-01
   192   1.231e-01     1.009e+01    3.360e-16     5.563e-16        1.057e-01
   193   1.241e-01     1.021e+01    3.481e-16     6.095e-16        1.048e-01
   194   1.252e-01     1.034e+01    3.257e-16     6.073e-16        1.039e-01
   195   1.262e-01     1.046e+01    3.282e-16     5.856e-16        1.029e-01
   196   1.272e-01     1.059e+01    3.182e-16     5.759e-16        1.020e-01
   197   1.282e-01     1.072e+01    3.333e-16     5.898e-16        1.012e-01
   198   1.292e-01     1.085e+01    3.435e-16     5.656e-16        1.003e-01
   199   1.302e-01     1.098e+01    3.386e-16     5.786e-16        9.940e-02
   200   6.564e-02     1.104e+01  --- Averaging step
   200   1.313e-01     1.104e+01    1.588e-04     5.593e-16        9.854e-02 --- CheckPoint

   step  timestep   time     meanKE   vorticity
   201   1.323e-01     1.118e+01    3.401e-16     1.001e-15        9.782e-02
   202   1.374e-01     1.131e+01    3.393e-16     6.076e-16        9.697e-02
   203   1.386e-01     1.145e+01    3.248e-16     5.785e-16        9.612e-02
   204   1.400e-01     1.159e+01    3.335e-16     6.189e-16        9.527e-02
   205   1.411e-01     1.173e+01    3.418e-16     6.215e-16        9.442e-02
   206   1.423e-01     1.187e+01    3.419e-16     6.228e-16        9.359e-02
   207   1.435e-01     1.202e+01    3.323e-16     5.951e-16        9.277e-02
   208   1.447e-01     1.216e+01    3.367e-16     6.016e-16        9.195e-02
   209   1.459e-01     1.231e+01    3.626e-16     6.045e-16        9.114e-02
   210   7.360e-02     1.238e+01  --- Averaging step
   210   1.472e-01     1.238e+01    1.360e-04     5.427e-16        9.034e-02
   211   1.485e-01     1.253e+01    3.586e-16     9.705e-16        8.969e-02
   212   1.545e-01     1.269e+01    3.464e-16     6.180e-16        8.891e-02
   213   1.560e-01     1.284e+01    3.681e-16     5.838e-16        8.811e-02
   214   1.576e-01     1.300e+01    3.569e-16     6.138e-16        8.731e-02
   215   1.591e-01     1.316e+01    3.640e-16     5.773e-16        8.652e-02
   216   1.605e-01     1.332e+01    3.583e-16     5.990e-16        8.574e-02
   217   1.620e-01     1.348e+01    3.529e-16     6.009e-16        8.496e-02
   218   1.635e-01     1.364e+01    3.447e-16     6.189e-16        8.416e-02
   219   1.651e-01     1.381e+01    3.636e-16     6.004e-16        8.332e-02
   220   8.344e-02     1.389e+01  --- Averaging step
   220   1.669e-01     1.389e+01    1.182e-04     5.930e-16        8.237e-02
   221   1.687e-01     1.406e+01    3.475e-16     1.020e-15        8.159e-02
   222   1.763e-01     1.424e+01    3.707e-16     6.182e-16        8.025e-02
   223   1.786e-01     1.442e+01    3.781e-16     6.102e-16        7.839e-02
   224   1.816e-01     1.460e+01    3.436e-16     6.083e-16        7.590e-02
   225   1.859e-01     1.478e+01    3.722e-16     6.316e-16        7.279e-02
   226   1.919e-01     1.498e+01    3.781e-16     6.194e-16        6.924e-02
   227   1.986e-01     1.517e+01    3.771e-16     6.301e-16        6.550e-02
   228   2.077e-01     1.538e+01    3.656e-16     6.021e-16        6.184e-02
   229   2.211e-01     1.560e+01    3.653e-16     5.906e-16        5.837e-02
   230   1.161e-01     1.572e+01  --- Averaging step
   230   2.321e-01     1.572e+01    8.799e-05     5.764e-16        5.485e-02
   231   2.455e-01     1.597e+01    3.753e-16     9.281e-16        5.292e-02
   232   2.754e-01     1.624e+01    3.666e-16     5.751e-16        4.899e-02
   233   2.924e-01     1.653e+01    3.656e-16     5.810e-16        4.481e-02
   234   3.158e-01     1.685e+01    3.544e-16     5.709e-16        4.097e-02
   235   3.443e-01     1.719e+01    3.703e-16     5.972e-16        3.753e-02
   236   3.711e-01     1.756e+01    3.899e-16     6.233e-16        3.435e-02
   237   3.951e-01     1.796e+01    3.631e-16     6.041e-16        3.140e-02
   238   4.196e-01     1.838e+01    3.707e-16     5.980e-16        2.861e-02
   239   4.488e-01     1.883e+01    3.627e-16     5.932e-16        2.585e-02
   240   2.411e-01     1.907e+01  --- Averaging step
   240   4.821e-01     1.907e+01    9.058e-05     5.750e-16        2.307e-02
   241   5.168e-01     1.959e+01    3.740e-16     9.264e-16        2.170e-02
   242   5.937e-01     2.018e+01    3.799e-16     6.015e-16        1.897e-02
   243   6.385e-01     2.082e+01    3.631e-16     5.923e-16        1.627e-02
   244   6.886e-01     2.151e+01    3.773e-16     6.360e-16        1.382e-02
   245   7.465e-01     2.225e+01    3.744e-16     6.282e-16        1.159e-02
   246   8.164e-01     2.307e+01    3.748e-16     6.051e-16        9.471e-03
   247   8.857e-01     2.396e+01    3.621e-16     6.158e-16        7.378e-03
   248   9.695e-01     2.492e+01    3.696e-16     5.909e-16        5.361e-03
   249   1.028e+00     2.595e+01    3.619e-16     5.650e-16        3.470e-03
   250   5.370e-01     2.649e+01  --- Averaging step
   250   1.074e+00     2.649e+01    6.457e-05     5.728e-16        1.871e-03
   251   1.110e+00     2.760e+01    3.750e-16     9.378e-16        1.260e-03
   252   1.187e+00     2.879e+01    3.835e-16     5.629e-16        6.722e-04
   253   1.233e+00     3.002e+01    3.716e-16     5.918e-16        6.978e-04
   254   1.365e+00     3.138e+01    3.657e-16     5.995e-16        6.043e-04
   255   1.577e+00     3.296e+01    3.679e-16     6.123e-16        4.749e-04
   256   1.711e+00     3.467e+01    3.832e-16     5.958e-16        4.378e-04
   257   1.836e+00     3.651e+01    3.803e-16     5.899e-16        3.730e-04
   258   2.027e+00     3.853e+01    3.672e-16     5.900e-16        3.090e-04
   259   2.174e+00     4.071e+01    3.714e-16     5.942e-16        2.699e-04
   260   1.174e+00     4.188e+01  --- Averaging step
   260   2.347e+00     4.188e+01    2.793e-05     5.803e-16        2.397e-04
   261   2.541e+00     4.442e+01    3.783e-16     9.312e-16        1.631e-04
   262   3.015e+00     4.744e+01    3.692e-16     6.307e-16        1.363e-04
   263   3.326e+00     5.076e+01    3.657e-16     6.109e-16        1.080e-04
   264   3.987e+00     5.475e+01    3.870e-16     6.448e-16        7.941e-05
   265   4.673e+00     5.942e+01    3.699e-16     6.314e-16        6.835e-05
   266   5.478e+00     6.490e+01    3.841e-16     6.270e-16        4.416e-05
   267   6.794e+00     7.170e+01    3.797e-16     5.942e-16        3.763e-05
   268   8.300e+00     8.000e+01    3.791e-16     6.178e-16        2.573e-05
   269   1.010e+01     9.010e+01    3.923e-16     5.946e-16        1.940e-05
   270   6.437e+00     9.654e+01  --- Averaging step
   270   1.287e+01     9.654e+01    6.779e-06     5.791e-16        1.217e-05
   271   1.679e+01     1.133e+02    3.768e-16     8.193e-16        7.856e-06
   272   2.235e+01     1.357e+02    3.738e-16     6.164e-16        4.995e-06
   273   3.152e+01     1.672e+02    3.854e-16     5.966e-16        3.123e-06
   274   4.577e+01     2.130e+02    3.934e-16     5.853e-16        1.410e-06
   275   8.021e+01     2.932e+02    3.772e-16     5.994e-16        1.634e-06
   276   1.040e+02     3.972e+02    3.817e-16     5.664e-16        1.376e-06
   277   1.299e+02     5.271e+02    3.537e-16     6.038e-16        7.909e-07
   278   1.741e+02     7.012e+02    3.786e-16     6.196e-16        2.960e-07
   279   2.548e+02     9.560e+02    3.523e-16     6.329e-16        5.547e-07
   280   1.520e+02     1.108e+03  --- Averaging step
   280   3.039e+02     1.108e+03    1.558e-06     6.003e-16        6.924e-07
   281   3.336e+02     1.442e+03    3.697e-16     9.574e-16        9.548e-08
   282   7.604e+02     2.202e+03    3.719e-16     6.068e-16        7.530e-08
   283   1.076e+03     3.278e+03    3.662e-16     6.079e-16        4.092e-08
   284   1.796e+03     5.074e+03    3.585e-16     5.959e-16        1.036e-08
   285   3.089e+03     8.163e+03    3.772e-16     6.234e-16        2.048e-08
   286   4.602e+03     1.277e+04    3.858e-16     6.121e-16        2.836e-08
   287   5.514e+03     1.828e+04    3.761e-16     6.101e-16        2.725e-08
   288   6.604e+03     2.488e+04    3.731e-16     6.196e-16        2.304e-08
   289   7.705e+03     3.259e+04    3.799e-16     5.792e-16        2.184e-08
   290   4.396e+03     3.699e+04  --- Averaging step
   290   8.793e+03     3.699e+04    1.755e-07     5.647e-16        2.333e-08
   291   9.576e+03     4.656e+04    3.650e-16     9.156e-16        6.488e-10
   292   3.727e+04     8.383e+04    3.760e-16     6.059e-16        4.815e-10
   293   6.314e+04     1.470e+05    3.501e-16     6.141e-16        2.742e-10
   294   1.315e+05     2.785e+05    3.668e-16     6.133e-16        1.408e-10
   295   2.367e+05     5.152e+05    3.858e-16     5.985e-16        1.838e-10
   296   3.773e+05     8.924e+05    3.915e-16     6.209e-16        2.176e-10
   297   5.061e+05     1.399e+06    3.667e-16     6.205e-16        2.169e-10
   298   6.442e+05     2.043e+06    3.731e-16     6.147e-16        2.046e-10
   299   7.789e+05     2.822e+06    3.797e-16     6.066e-16        2.000e-10
   300   4.534e+05     3.275e+06  --- Averaging step
   300   9.068e+05     3.275e+06    3.907e-08     5.893e-16        2.028e-10
   301   1.015e+06     4.290e+06    3.630e-16     9.278e-16        1.612e-12
   302   5.926e+06     1.022e+07    3.775e-16     5.996e-16        1.082e-12
   303   1.187e+07     2.209e+07    3.672e-16     6.209e-16        6.863e-13
   304   3.003e+07     5.211e+07    3.750e-16     6.066e-16        4.809e-13
   305   4.789e+07     1.000e+08    3.896e-16     5.638e-16        5.275e-13
finished in  305 steps!
final time solution data is saved in stabtrNS_end.mat
Integration took  1.165e+01 seconds

use new (enter figno) or existing (0) figure, default is 0 : 16
305 timesteps

Generating movies ... 
%--------- movie generation might fail with unhelpful MATLAB error message
%--------- Error... the specified profile is not valid. 
%--------- It will almost certainly fail in Octave 
   Segment 1: Time steps 1 to 200
      computing divergence of discrete velocity solution ...  done
      estimated velocity divergence error:  1.165798e-02 
      minimum energy is 3.18162e-08       and maximum is 3.34542
   Segment 2: Time steps 201 to 305
      computing divergence of discrete velocity solution ...  done
      estimated velocity divergence error:  2.016507e-07 
      minimum energy is 3.347       and maximum is 3.42544
All done

%--------- the following code should work even if movie generation fails
load MovieData1
snaptime=[10,50,100,200];
channel_unsteadyflowrefX(qmethod,U,time,By,Bx,A,xy,x,y,bound,bndxy,bnde,snaptime);

   Plotting flow field snapshots ... 
   step   time       min_phi    max_phi
    10     0.049    -0.00000   5.142e-01
    50     0.886    -0.00000   1.333e+00
   100     3.017    -0.00000   1.333e+00
   200    11.043    -0.00000   1.333e+00

load MovieData2
ufinal=U(:,end);
load steadysol
norm(ufinal-xns(1:nnv),inf)
ans = 7.3796e-07


restart_channel_navier
Navier-Stokes flow in channel domain ... 
Restarting integration from Checkpoint datafile ...
viscosity parameter is    1.000e-03
restarting from   1.000e+08 seconds
new final time? (1e14) : 
number of timesteps (x200)? (default 5) : 
accuracy tolerance? (default 3e-5) : 1e-4
number of Picard steps? (default 1) : 
averaging frequency? (default 10) : 
plot solution evolution? 1/0 : 0
Solving discrete N-S system using stabilized TR ...

AxBhandle = @defaultAxB


Timestep   305  Time   1.000e+08 
Restarting integration ...
 
 StabTR with  1 nonlinear corrections
   step  timestep       time        residual      divresidual     acceleration
  4.11e-14   --- nonlinear correction  
     2   1.840e+08     2.840e+08    3.692e-16     5.910e-16        5.821e-13
  1.47e-14   --- nonlinear correction  
     3   2.093e+08     4.933e+08    3.807e-16     5.723e-16        5.899e-13
  4.37e-15   --- nonlinear correction  
     4   2.698e+08     7.631e+08    3.628e-16     6.201e-16        5.921e-13
  1.49e-15   --- nonlinear correction  
     5   3.059e+08     1.069e+09    3.945e-16     6.228e-16        5.928e-13
  5.24e-16   --- nonlinear correction  
     6   3.470e+08     1.416e+09    3.713e-16     6.378e-16        5.931e-13
  1.83e-16   --- nonlinear correction  
     7   3.773e+08     1.793e+09    3.725e-16     5.689e-16        5.932e-13
  6.44e-17   --- nonlinear correction  
     8   4.046e+08     2.198e+09    3.691e-16     5.771e-16        5.932e-13
  2.21e-17   --- nonlinear correction  
     9   4.258e+08     2.624e+09    3.646e-16     5.780e-16        5.932e-13
  7.50e-18   --- nonlinear correction  
    10   2.217e+08     2.845e+09  --- Averaging step
    10   4.433e+08     2.845e+09    1.401e-11     5.850e-16        5.932e-13
  2.42e-18   --- nonlinear correction  
    11   4.570e+08     3.302e+09    3.591e-16     9.555e-16        8.650e-19
  6.49e-19   --- nonlinear correction  
    12   3.716e+10     4.046e+10    3.964e-16     6.798e-16        3.124e-19
  5.42e-20   --- nonlinear correction  
    13   2.059e+11     2.463e+11    3.843e-16     6.482e-16        2.718e-19
  1.20e-20   --- nonlinear correction  
    14   1.997e+12     2.243e+12    3.675e-16     6.592e-16        2.616e-19
  1.44e-21   --- nonlinear correction  
    15   7.738e+12     9.981e+12    3.607e-16     6.586e-16        2.606e-19
  3.51e-22   --- nonlinear correction  
    16   2.609e+13     3.607e+13    3.844e-16     6.652e-16        2.604e-19
  6.80e-23   --- nonlinear correction  
    17   6.149e+13     9.757e+13    3.721e-16     6.696e-16        2.603e-19
  1.46e-22   --- nonlinear correction  
    18   2.434e+12     1.000e+14    3.837e-16     6.479e-16        2.603e-19
finished in   18 steps!
final time solution data is saved in stabtrNS_end.mat
Integration took  1.550e+00 seconds
305 timesteps
use new (enter figno) or existing (0) figure, default is 0 : 
figure number (default is current active figure) : 
324 timesteps
All done

load MovieData1
load steadysol 
ufinal=U(:,end);
norm(ufinal-xns(1:nnv),inf)
ans = 4.1338e-08

diary off
